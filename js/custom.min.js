var mywrapper = document.createElement('div');
var body = document.querySelector('body');
var view = document.querySelector('.view');
mywrapper.classList = 'words-wrapper';
body.appendChild(mywrapper);
var team = " ";
var otherteam = " ";
var list25 = [
    'Cheval', 'Lion', 'Australie', 'Belgique', 'Diplôme',
    'Ordinateur', 'Souris', 'Figurine', 'Voyage', 'Trou',
    'Bête', 'Clé', 'Téléphone', 'Vaisseau', 'Gourde',
    'Câble', 'Poney', 'Diplomate', 'Image', 'Terre',
    'Courir', 'Boire', 'Mousse', 'Bière', 'Verre'
];

var teamwordsremaning = 8;
var otherteamwordsremaning = 7
var countwordsTeam = 8;
var countWordsOtherTeam = 7;
var countNeutral = 10;
var blackword = false;

function inializeTeam() {
    if ((Random(0, 2)) == 0) {
        team = "blue";
        otherteam = "red";
    } else {
        team = "red";
        otherteam = "blue";
    }
}

function selectAndRemoveWord(arrayofwords) {
    var randomWord = Random(0, (arrayofwords.length));
    var wordtoRemove = arrayofwords[randomWord]
    arrayofwords.splice(randomWord, 1);
    return wordtoRemove;
}

function inializeGridOfWords(listofwords) {
    for (var i = 1; i <= 5; i++) {
        for (var j = 1; j <= 5; j++) {
            var myword = document.createElement('div');
            myword.className = 'a-word';
            myword.setAttribute('data-grid_place', (i + 'x' + j));
            /*var randomWord = Random(0, (listofwords.length));
            myword.textContent = listofwords[randomWord];
            listofwords.splice(randomWord, 1);*/
            /** 
            ALTERNATIVE A DEVELOPPER 
            1.QUERYSELECTORALL
            2. BOUCLE WHILE
            2.CHOISUR UN ELEMENT RANDOM
            3. ADD 8 ROUGES EN RETIRANT L'ELEMENT A CHAQUE FOIS
            4. ADD 7 BLEU EN RETIRANT L'ELEMENT A CHAQUE FOIS
            5. ADD 9 NEUTRE EN RETIRANT L'ELEMENT A CHAQUE FOIS
            6. ADD 1 BLACK
            **/
            var random = Random(0, 3)
            if (random == 1 && countwordsTeam > 0) {
                if (countwordsTeam > 0) {
                    myword.setAttribute('data-team', 'team');
                    countwordsTeam--;
                    myword.textContent = selectAndRemoveWord(listofwords);
                    mywrapper.appendChild(myword);
                } else if (countWordsOtherTeam > 0) {
                    myword.setAttribute('data-team', 'otherteam');
                    countWordsOtherTeam--;
                    myword.textContent = selectAndRemoveWord(listofwords);
                    mywrapper.appendChild(myword);
                } else {
                    myword.setAttribute('data-team', 'neutral');
                    countNeutral--;
                    myword.textContent = selectAndRemoveWord(listofwords);
                    mywrapper.appendChild(myword);
                }
            } else if (random == 2 && countWordsOtherTeam > 0) {
                if (countWordsOtherTeam > 0) {
                    myword.setAttribute('data-team', 'otherteam');
                    countWordsOtherTeam--;
                    myword.textContent = selectAndRemoveWord(listofwords);
                    mywrapper.appendChild(myword);
                } else if (countwordsTeam > 0) {
                    countwordsTeam--;
                    myword.textContent = selectAndRemoveWord(listofwords);
                    mywrapper.appendChild(myword);
                } else {
                    myword.setAttribute('data-team', 'neutral');
                    countNeutral--;
                    myword.textContent = selectAndRemoveWord(listofwords);
                    mywrapper.appendChild(myword);
                }
            } else if (countNeutral > 0) {
                myword.setAttribute('data-team', 'neutral');
                countNeutral--;
                myword.textContent = selectAndRemoveWord(listofwords);
                mywrapper.appendChild(myword);

            } else {
                j--;
            }
        }
    }
    let myneutral = document.querySelectorAll('[data-team="neutral"]')
    let blackrandom = myneutral[Random(0, myneutral.length)];
    console.log(blackrandom);
    blackrandom.setAttribute('data-team', 'blackword');
}

function Random(min, max) {
    return Math.floor(Math.random() * (max - min) + min);
}

function gamefinished() {
    if (otherteamwordsremaning <= 0 || teamwordsremaning <= 0 || blackword == true) {
        return true;
    } else {
        return false;
    }
}

mywrapper.addEventListener("click", function (e) {
    teamwordclicked = e.target.getAttribute("data-team");
    if (teamwordclicked == "team") {
        console.log("BIEN JOUÉ !!");
        teamwordsremaning--;
    } else if (teamwordclicked == "otherteam") {
        console.log("AIE !!");
        otherteamwordsremaning--;
    } else if (teamwordclicked == "blackword") {
        console.log('MOT BLACK')
        blackword = true;
    } else {
        console.log('MOT NEUTRE')
    }
    console.log(e.target);
    e.target.classList.add('active');
    if (gamefinished()) {
        document.querySelector('.wrapper').classList.add('active');
    }
});
view.addEventListener("click", function () {
    let arrayofwords = document.querySelectorAll('.a-word');

    for (let i = 0; i < arrayofwords.length; i++) {
        arrayofwords[i].classList.toggle('temp');
    }
});
let targetURL = "getjson.php";
let hxr = new XMLHttpRequest();
hxr.addEventListener('readystatechange', function (event) {
    if (hxr.readyState == 4 && hxr.status == 200) {
        let data = JSON.parse(event.currentTarget.responseText);
        let list25 = [];
        console.log(data.length);
        for (let i = 0; i < data.length; i++) {
            list25.push(data[i].mots);
        }
        inializeTeam()
        inializeGridOfWords(list25);

    } else if (hxr.readyState == 4 && hxr.status == 404) {
        let monDiv = document.createElement('div');
        monDiv.textContent = 'Service temporairement down';
    }
});
hxr.open('GET', targetURL, true);
hxr.send();
